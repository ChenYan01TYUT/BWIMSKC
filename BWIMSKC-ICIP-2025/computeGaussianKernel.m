% 假设稀疏化后的X已存在于工作空间中
% 你可以使用下面的代码来计算高斯核矩阵

function K = computeGaussianKernel(X)
    % 输入：
    % X - 稀疏化后的数据矩阵，大小为 nSmp x d
    
    [nSmp, ~] = size(X);  % 获取样本数
    % 计算数据点之间的欧氏距离矩阵
    D = EuDist2(X, X, 1);  % EuDist2函数计算欧氏距离
    
    % 计算欧氏距离的均值（用于高斯核的参数 t）
    s = mean(D(:));  % 求所有距离的均值
    
    % 设置高斯核的参数 t（通过对每个元素进行调整）
    t = sqrt(s);  % 对均值的平方根作为 t
    
    % 使用高斯核公式计算相似度矩阵 K
    K = exp(-D / (2 * t^2));  % 高斯核公式：K(i,j) = exp(-|X(i) - X(j)|^2 / (2 * t^2))
    
    % 保证核矩阵是对称的（在某些情况下可能已经是对称的）
    K = max(K, K');
end

